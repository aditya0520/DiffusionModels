11/07/2024 23:16:05 - INFO - __main__ - ***** Training arguments *****
11/07/2024 23:16:05 - INFO - __main__ - Namespace(config='configs/ddpm.yaml', data_dir='./data/imagenet100_128x128/train', image_size=128, batch_size=8, num_workers=8, num_classes=100, run_name='exp-4', output_dir='experiments', num_epochs=10, learning_rate=0.0001, weight_decay=0.0001, grad_clip=1.0, seed=42, mixed_precision='none', num_train_timesteps=1000, num_inference_steps=200, beta_start=0.0002, beta_end=0.02, beta_schedule='linear', variance_type='fixed_small', prediction_type='epsilon', clip_sample=True, clip_sample_range=1.0, unet_in_size=128, unet_in_ch=3, unet_ch=128, unet_ch_mult=[1, 2, 2, 2], unet_attn=[1, 2, 3], unet_num_res_blocks=2, unet_dropout=0.0, latent_ddpm=False, use_cfg=False, cfg_guidance_scale=2.0, use_ddim=False, ckpt='./checkpoint', distributed=False, world_size=1, rank=0, local_rank=0, device='cuda', total_batch_size=8, max_train_steps=162500)
11/07/2024 23:16:05 - INFO - __main__ - ***** Running training *****
11/07/2024 23:16:05 - INFO - __main__ -   Num examples = 130000
11/07/2024 23:16:05 - INFO - __main__ -   Num Epochs = 10
11/07/2024 23:16:05 - INFO - __main__ -   Instantaneous batch size per device = 8
11/07/2024 23:16:05 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 8
11/07/2024 23:16:05 - INFO - __main__ -   Total optimization steps per epoch 16250
11/07/2024 23:16:05 - INFO - __main__ -   Total optimization steps = 162500
  0% 0/162500 [00:00<?, ?it/s]11/07/2024 23:16:05 - INFO - __main__ - Epoch 1/10
/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
  0% 1/162500 [00:02<99:57:55,  2.21s/it]11/07/2024 23:16:07 - INFO - __main__ - Epoch 1/10, Step 0/16250, Loss 0.9961827993392944 (0.9961827993392944)
  0% 101/162500 [01:27<39:54:13,  1.13it/s]11/07/2024 23:17:33 - INFO - __main__ - Epoch 1/10, Step 100/16250, Loss 0.42126500606536865 (0.7265165341962682)
  0% 201/162500 [02:55<39:27:38,  1.14it/s]11/07/2024 23:19:00 - INFO - __main__ - Epoch 1/10, Step 200/16250, Loss 0.047756992280483246 (0.45203711980240263)
  0% 301/162500 [04:22<39:23:30,  1.14it/s]11/07/2024 23:20:28 - INFO - __main__ - Epoch 1/10, Step 300/16250, Loss 0.012739412486553192 (0.31555563089378996)
  0% 401/162500 [05:49<39:18:49,  1.15it/s]11/07/2024 23:21:55 - INFO - __main__ - Epoch 1/10, Step 400/16250, Loss 0.013835230842232704 (0.24417774866746175)
  0% 501/162500 [07:17<39:25:23,  1.14it/s]11/07/2024 23:23:23 - INFO - __main__ - Epoch 1/10, Step 500/16250, Loss 0.010502263903617859 (0.20163913581663456)
  0% 601/162500 [08:44<39:18:38,  1.14it/s]11/07/2024 23:24:50 - INFO - __main__ - Epoch 1/10, Step 600/16250, Loss 0.01409834623336792 (0.17315751133825996)
  0% 701/162500 [10:12<39:16:11,  1.14it/s]11/07/2024 23:26:17 - INFO - __main__ - Epoch 1/10, Step 700/16250, Loss 0.005000474862754345 (0.1531699114069263)
  0% 801/162500 [11:39<39:16:23,  1.14it/s]11/07/2024 23:27:45 - INFO - __main__ - Epoch 1/10, Step 800/16250, Loss 0.012414968572556973 (0.13776683156813416)
  1% 901/162500 [13:07<39:10:40,  1.15it/s]11/07/2024 23:29:12 - INFO - __main__ - Epoch 1/10, Step 900/16250, Loss 0.03917693346738815 (0.12560267368570327)
  1% 1001/162500 [14:34<39:23:05,  1.14it/s]11/07/2024 23:30:40 - INFO - __main__ - Epoch 1/10, Step 1000/16250, Loss 0.02245078608393669 (0.11608452213482445)
  1% 1101/162500 [16:01<39:10:46,  1.14it/s]11/07/2024 23:32:07 - INFO - __main__ - Epoch 1/10, Step 1100/16250, Loss 0.015644941478967667 (0.1078416606727277)
  1% 1201/162500 [17:29<39:11:01,  1.14it/s]11/07/2024 23:33:35 - INFO - __main__ - Epoch 1/10, Step 1200/16250, Loss 0.014212294481694698 (0.10149446738434864)
  1% 1301/162500 [18:56<39:15:00,  1.14it/s]11/07/2024 23:35:02 - INFO - __main__ - Epoch 1/10, Step 1300/16250, Loss 0.0030090573709458113 (0.09575105911954024)
  1% 1401/162500 [20:24<39:07:17,  1.14it/s]11/07/2024 23:36:30 - INFO - __main__ - Epoch 1/10, Step 1400/16250, Loss 0.011919311247766018 (0.09093912016450136)
  1% 1501/162500 [21:51<39:20:02,  1.14it/s]11/07/2024 23:37:57 - INFO - __main__ - Epoch 1/10, Step 1500/16250, Loss 0.009012476541101933 (0.08680453437112451)
  1% 1601/162500 [23:19<39:19:37,  1.14it/s]11/07/2024 23:39:25 - INFO - __main__ - Epoch 1/10, Step 1600/16250, Loss 0.015505408868193626 (0.08289252333025995)
  1% 1701/162500 [24:47<39:12:25,  1.14it/s]11/07/2024 23:40:52 - INFO - __main__ - Epoch 1/10, Step 1700/16250, Loss 0.02567949704825878 (0.07950933256075947)
  1% 1801/162500 [26:14<39:14:59,  1.14it/s]11/07/2024 23:42:20 - INFO - __main__ - Epoch 1/10, Step 1800/16250, Loss 0.025768017396330833 (0.07652227917718683)
  1% 1901/162500 [27:42<39:03:10,  1.14it/s]11/07/2024 23:43:47 - INFO - __main__ - Epoch 1/10, Step 1900/16250, Loss 0.006295662373304367 (0.07386793639216432)
  1% 2001/162500 [29:09<39:07:52,  1.14it/s]11/07/2024 23:45:15 - INFO - __main__ - Epoch 1/10, Step 2000/16250, Loss 0.005769230425357819 (0.0714999563807132)
  1% 2101/162500 [30:37<39:04:59,  1.14it/s]11/07/2024 23:46:43 - INFO - __main__ - Epoch 1/10, Step 2100/16250, Loss 0.018386635929346085 (0.06926247291150558)
  1% 2201/162500 [32:05<39:02:46,  1.14it/s]11/07/2024 23:48:10 - INFO - __main__ - Epoch 1/10, Step 2200/16250, Loss 0.01908371038734913 (0.067135177042345)
  1% 2301/162500 [33:32<38:57:52,  1.14it/s]11/07/2024 23:49:38 - INFO - __main__ - Epoch 1/10, Step 2300/16250, Loss 0.02087368071079254 (0.06525516908427417)
  1% 2401/162500 [35:00<38:55:08,  1.14it/s]11/07/2024 23:51:05 - INFO - __main__ - Epoch 1/10, Step 2400/16250, Loss 0.003007693914696574 (0.06355760121876695)
  2% 2501/162500 [36:27<39:01:12,  1.14it/s]11/07/2024 23:52:33 - INFO - __main__ - Epoch 1/10, Step 2500/16250, Loss 0.017116237431764603 (0.06190010027686988)
  2% 2601/162500 [37:55<39:04:02,  1.14it/s]11/07/2024 23:54:00 - INFO - __main__ - Epoch 1/10, Step 2600/16250, Loss 0.007663983851671219 (0.06044450298452808)
  2% 2701/162500 [39:23<38:51:13,  1.14it/s]11/07/2024 23:55:28 - INFO - __main__ - Epoch 1/10, Step 2700/16250, Loss 0.040571656078100204 (0.059036695725827246)
  2% 2801/162500 [40:50<38:53:34,  1.14it/s]11/07/2024 23:56:56 - INFO - __main__ - Epoch 1/10, Step 2800/16250, Loss 0.011287778615951538 (0.05783354440759349)
  2% 2901/162500 [42:18<38:59:11,  1.14it/s]11/07/2024 23:58:23 - INFO - __main__ - Epoch 1/10, Step 2900/16250, Loss 0.01535856258124113 (0.05656196903391628)
  2% 3001/162500 [43:45<38:48:02,  1.14it/s]11/07/2024 23:59:51 - INFO - __main__ - Epoch 1/10, Step 3000/16250, Loss 0.01986771821975708 (0.05539248756765177)
  2% 3101/162500 [45:13<38:56:27,  1.14it/s]11/08/2024 00:01:19 - INFO - __main__ - Epoch 1/10, Step 3100/16250, Loss 0.02352800779044628 (0.05439908558994433)
  2% 3201/162500 [46:41<38:41:08,  1.14it/s]11/08/2024 00:02:46 - INFO - __main__ - Epoch 1/10, Step 3200/16250, Loss 0.03429655730724335 (0.05340394140229907)
  2% 3301/162500 [48:08<38:52:34,  1.14it/s]11/08/2024 00:04:14 - INFO - __main__ - Epoch 1/10, Step 3300/16250, Loss 0.03132080286741257 (0.05244804164214171)
  2% 3401/162500 [49:36<38:47:25,  1.14it/s]11/08/2024 00:05:41 - INFO - __main__ - Epoch 1/10, Step 3400/16250, Loss 0.019810397177934647 (0.05152857671287792)
  2% 3501/162500 [51:04<38:47:52,  1.14it/s]11/08/2024 00:07:09 - INFO - __main__ - Epoch 1/10, Step 3500/16250, Loss 0.002674105344340205 (0.05073098697872783)
  2% 3601/162500 [52:31<38:48:20,  1.14it/s]11/08/2024 00:08:37 - INFO - __main__ - Epoch 1/10, Step 3600/16250, Loss 0.017639970406889915 (0.0499776003254338)
  2% 3701/162500 [53:59<38:48:40,  1.14it/s]11/08/2024 00:10:05 - INFO - __main__ - Epoch 1/10, Step 3700/16250, Loss 0.041285812854766846 (0.0492048313919484)
  2% 3801/162500 [55:27<38:36:49,  1.14it/s]11/08/2024 00:11:32 - INFO - __main__ - Epoch 1/10, Step 3800/16250, Loss 0.007889173924922943 (0.04840612471608655)
  2% 3901/162500 [56:54<38:32:54,  1.14it/s]11/08/2024 00:13:00 - INFO - __main__ - Epoch 1/10, Step 3900/16250, Loss 0.02942340075969696 (0.047705016983505856)
  2% 3933/162500 [57:22<38:44:21,  1.14it/s]Traceback (most recent call last):
  File "/content/hw5_code/train.py", line 396, in <module>
    main()
  File "/content/hw5_code/train.py", line 303, in main
    images = images.to(device)
KeyboardInterrupt
